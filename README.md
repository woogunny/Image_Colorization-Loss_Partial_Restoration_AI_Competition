


# 이미지 복원 및 색상화

이 프로젝트는 손상된 그레이스케일 이미지를 복원하고 이를 컬러 이미지로 변환하는 것을 목표로 합니다. 아래는 구현의 세부 사항입니다.

---

## 1. 개요

이 프로젝트는 다음을 수행합니다:
1. **그레이스케일 복원**: 손상된 그레이스케일 이미지의 누락된 부분을 복원합니다.
2. **색상화**: 복원된 그레이스케일 이미지를 RGB 컬러 이미지로 변환합니다.

주요 특징:
- **U-Net 모델**: 두 단계 복원(U-Net 기반 그레이스케일 복원 및 색상화).
- **데이터 처리**: 다각형 기반 마스킹을 사용한 손상 이미지 생성.
- **평가 지표**: SSIM 및 히스토그램 유사도를 사용한 성능 평가.

---

## 2. 데이터 처리

### 입력 데이터
- 랜덤 다각형을 사용하여 손상된 영역을 시뮬레이션합니다.
- 손상된 영역은 랜덤 그레이스케일 값으로 채워집니다.

### 폴더 구조
- `train_gt`: 학습용 원본 이미지.
- `valid_input`: 검증용 이미지.
- `test_input1`: 테스트 이미지.

### 데이터 분할
- **K-Fold 교차 검증**: 데이터셋을 학습 및 검증 하위 집합으로 분할.
- `sklearn.model_selection`의 `KFold`를 사용하여 구현.

---

## 3. 모델 구조

### 모델 1: 그레이스케일 복원
- 손상된 그레이스케일 영역을 복원.
- U-Net을 사용하며, EfficientNet-B3(사전 학습된 가중치 사용)를 인코더로 사용.

### 모델 2: 색상화
- 복원된 그레이스케일 이미지를 RGB 컬러 이미지로 변환.
- 모델 1과 동일한 U-Net 구조.

#### U-Net 구조:
```
                입력 이미지 (손상 이미지)    
                         │  
     ┌───────────────── 인코더 ─────────────────┐  
     ↓                                           ↓  
    특징 추출                              스킵 연결  
     ↓                                           ↓  
     └───────────────── 디코더 ─────────────────┘  
                         │  
                출력 이미지 (복원 이미지)  
```

---

## 4. 평가 지표

### 1. SSIM (구조적 유사성 지수)
- 복원된 이미지와 원본 이미지 간의 구조적 유사성을 평가.
- 전체 이미지와 손상된 영역에서 계산.

### 2. 히스토그램 유사도
- HSV 색 공간에서 원본과 복원된 이미지 간 색상 분포 유사성을 측정.

---

## 5. GAN 손실 (계획 중)

### GAN Inpainting Loss
- 손상 영역 복원을 개선하기 위한 GAN 기반 손실.

### GAN Color Loss
- 색상화 품질을 개선하기 위한 GAN 기반 손실.

> 참고: 시간 제약으로 인해 구현되지 않았으며, 추후 작업 계획에 포함됨.

---

## 6. 실험 결과





손상 이미지


![TRAIN_00010](https://github.com/user-attachments/assets/f385fa6c-2b53-4aed-b3af-c2e384782dd1)


원본 이미지


![TRAIN_00010 (gt)](https://github.com/user-attachments/assets/a76f542a-b174-4f3e-b35e-18f3d06f9744)


복원 이미지


![TEST_000](https://github.com/user-attachments/assets/e44700f3-823b-4732-b76e-677ebe997450)


---

## 7. 추후 계획

1. **GAN Inpainting Loss** 및 **GAN Color Loss** 구현.
2. 더 넓은 데이터셋을 사용하여 일반화 성능 강화.
3. 복원 품질의 다각적 분석을 위한 추가 평가 지표 도입.

---

## 8. 참고 자료

- [U-Net: Convolutional Networks for Biomedical Image Segmentation](https://arxiv.org/abs/1505.04597)
- [EfficientNet](https://arxiv.org/abs/1905.11946)

## 9. 실험 과정 설명



![image](https://github.com/user-attachments/assets/7a527ba9-d39a-44fc-9fae-42b40ae521db)


### 1. 학습 및 검증 손실 (Train and Validation Loss)
- 손실(Loss)은 학습이 진행됨에 따라 꾸준히 감소하고 있습니다.
- 초기 학습 단계에서 급격히 감소한 뒤, 후반부에는 안정적인 수준으로 수렴하는 모습을 보입니다.
- 검증 손실도 학습 손실과 비슷한 경향을 보이며, 학습이 잘 이루어지고 있음을 확인할 수 있습니다.

### 2. 검증 SSIM (Validation SSIM)
- SSIM(Structural Similarity Index)은 학습이 진행됨에 따라 지속적으로 향상됩니다.
- 초반에 변동성이 있지만, 학습 후반부로 갈수록 안정적으로 상승하여 0.88에 도달했습니다.
- 이는 복원된 이미지가 원본 이미지와 점점 더 유사해지고 있음을 나타냅니다.

### 3. Discriminator 및 Generator 손실 (Loss D & Loss G)
- Discriminator와 Generator의 손실 변화는 GAN 학습의 동적 특성을 보여줍니다.
- Discriminator의 손실은 상승과 하강을 반복하며 안정적인 학습을 나타냅니다.
- Generator의 손실은 상대적으로 낮은 수준에서 유지되며, 점진적으로 손상된 영역 복원 능력이 향상되고 있음을 시사합니다.

### 4. 검증 Discriminator 및 Generator 손실 (Val loss D & Val loss G)
- 검증 단계에서도 유사한 패턴을 보여주며, Discriminator와 Generator의 균형이 학습 동안 잘 유지되었습니다.
- Discriminator의 손실이 안정화되었으며, Generator는 점차 손실을 줄이며 복원 품질을 개선했습니다.

### 5. 검증 색상 유사도 (Validation Color Similarity)
- 컬러 히스토그램 기반 유사도가 학습 진행과 함께 꾸준히 상승하였습니다.
- 학습 후반부에는 0.60에 도달하여 컬러 복원 품질이 초기 대비 크게 향상되었음을 확인할 수 있습니다.

### 6. Learning Rate 스케줄러 (Learning Rate Scheduler)
- Learning Rate가 주기적으로 변화하도록 설정하여 학습을 최적화하였습니다.
- 학습 속도를 조정함으로써 안정적인 수렴을 도왔습니다.


---

위 과정은 학습과 검증의 다양한 손실과 메트릭스를 종합적으로 평가하여 모델의 성능을 지속적으로 모니터링한 결과입니다. 특히 SSIM과 색상 유사도의 상승은 모델이 손상된 이미지 복원 및 컬러 변환에서 점점 더 높은 품질을 달성하고 있음을 보여줍니다.

